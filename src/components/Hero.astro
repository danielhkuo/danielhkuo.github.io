---
// Hero.astro - Receives skills as a prop and renders them dynamically.
interface Props {
  skills?: string[];
  bio?: string;
}

const { skills = [], bio = "" } = Astro.props;

import { getIcon } from "../consts/tech-stack";
import CarbonSocialLinks from "./CarbonSocialLinks.svelte";
---

<section
  class="hero-section bg-card-bg rounded-2xl p-8 shadow-lg mb-10 animate-float flex flex-col"
>
  <!-- Reduced bottom margin to close the "Vertical Void" -->
  <div class="hero-grid mb-6">
    <!-- Header Info -->
    <div class="hero-content text-center lg:text-left">
      <!-- Identity Block -->
      <div class="identity-block pl-8">
        <h1
          class="hero-title text-4xl lg:text-5xl font-bold text-primary micro-space-1"
        >
          Daniel Kuo
        </h1>
        <p class="hero-subtitle text-lg lg:text-xl text-accent micro-space-1">
          Computer Science | Developer | Tech Enthusiast
        </p>
        <p class="hero-education italic text-text-secondary mb-4">
          B.S. Computer Science @ Rice University
        </p>

        <!-- Bio Component -->
        {
          bio && (
            <p class="hero-bio text-text-secondary leading-relaxed max-w-prose ml-4 mt-4">
              {bio}
            </p>
          )
        }

        <!-- Contextual Social Links -->
        <!-- "Staircase" Fix: Strictly aligns with .hero-bio (ml-4) -->
        <div class="hero-socials ml-4">
          <CarbonSocialLinks client:load />
        </div>
      </div>
    </div>

    <!-- Headshot -->
    <div class="hero-image">
      <div class="headshot-container">
        <img
          alt="Daniel Kuo headshot"
          fetchpriority="high"
          decoding="async"
          loading="eager"
          class="headshot shadow-lg"
          src="/headshot.webp"
        />
      </div>
    </div>
  </div>

  <!-- Tech Stack Ribbon -->
  <!-- "Alignment Clash" Fix: Enforced justify-start on LG screens to match F-Pattern -->
  {
    skills.length > 0 && (
      <div class="tech-ribbon-wrapper mt-auto pt-4 border-t border-border-subtle">
        <div class="tech-ribbon flex flex-wrap justify-center lg:justify-start gap-4">
          {skills.map((skill) => (
            <div class="tech-item flex items-center gap-2 text-text-secondary hover:text-primary transition-colors duration-200">
              <i class:list={[getIcon(skill), "text-lg"]} />
              <span class="text-sm font-medium">{skill}</span>
            </div>
          ))}
        </div>
      </div>
    )
  }
</section>

<style>
  /* Responsive Grid Layout */
  .hero-grid {
    display: grid;
    grid-template-columns: 1fr; /* Default to 1 column (mobile) */
    gap: 2rem;
    align-items: center;
  }

  /* Ensure content and image take up space properly */
  .hero-content {
    min-width: 0; /* Prevent grid blowout */
  }

  .hero-image {
    display: flex;
    justify-content: center;
    order: -1;
    margin-bottom: 1rem;
  }

  /* Identity Block Typography Alignment */
  .identity-block > * {
    line-height: 1.15;
  }

  .identity-block .hero-title {
    margin-left: calc(1rem - 0.05em);
  }

  .identity-block .hero-subtitle {
    margin-left: calc(1rem - 0.02em);
  }

  .identity-block .hero-education {
    margin-left: calc(1rem + 0.1em);
    font-style: italic;
  }

  /* Unified indentation for Bio and Socials */
  .identity-block .hero-bio {
    margin-left: 1rem;
    margin-top: 1rem;
  }

  /* Matches bio margin exactly */
  .hero-socials {
    margin-left: 1rem;
  }

  .headshot-container {
    width: 200;
    height: auto;
    min-width: 200px;
  }

  .headshot {
    width: 100%;
    height: auto;
    max-width: 300px;
    aspect-ratio: 1;
    object-fit: cover;
  }

  /* Mobile: Reset margins for center alignment */
  @media (max-width: 671px) {
    .identity-block .hero-title,
    .identity-block .hero-subtitle,
    .identity-block .hero-education,
    .identity-block .hero-bio,
    .hero-socials {
      margin-left: 0;
    }

    .identity-block .hero-bio {
      margin-left: auto;
      margin-right: auto;
    }
  }

  /* Desktop Layout (672px+) */
  @media (min-width: 672px) {
    .hero-grid {
      grid-template-columns: 1.5fr 1fr;
    }

    .hero-image {
      order: 0;
      margin-bottom: 0;
      justify-content: center;
    }

    .headshot {
      max-width: 400px;
    }
  }
</style>
